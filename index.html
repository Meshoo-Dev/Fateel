<!DOCTYPE html>
<html lang="ar">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>ÙØªÙŠÙ„ â¤ï¸ğŸ”¥</title>

<style>
body {
  margin: 0;
  padding-bottom: 40px;
  font-family: Tahoma, Arial;
  background: linear-gradient(to bottom, #0b2a4a, #1e5aa8);
  color: white;
  text-align: center;
  direction: rtl;
  overflow-x: hidden;
}

.hero {
  padding: 20px;
}

.logo {
  width: 120px;
  margin-bottom: 10px;
}

.title {
  font-size: 58px;
  font-weight: 900; /* Ø®Ø· ØªØ®ÙŠÙ† */
  color: gold;
  text-shadow: 0 0 20px rgba(255,215,0,1);
  margin-bottom: 5px;
}

.images img {
  width: 120px;
  margin: 10px;
}

.box {
  background: rgba(255,255,255,0.15);
  border-radius: 15px;
  padding: 20px;
  margin: 20px;
  backdrop-filter: blur(6px);
}

input {
  width: 80%;
  padding: 12px;
  font-size: 18px;
  border-radius: 10px;
  border: none;
  text-align: center;
}

button {
  margin-top: 25px;
  padding: 12px 30px;
  font-size: 20px;
  background: linear-gradient(to right, #ff5722, #ff9800);
  color: white;
  border: none;
  border-radius: 30px;
}

#result {
  display: none;
  animation: fadeIn 1.2s ease forwards;
}

#chosenName {
  font-size: 50px;
  font-weight: bold;
  color: gold;
  text-shadow: 0 0 12px gold;
  display: inline-block;
  margin-left: 10px;
  animation: pop 1s ease forwards;
}

#candle {
  font-size: 50px;
  animation: candleBlink 1s infinite alternate;
}

@keyframes fadeIn {
  from { opacity: 0; }
  to { opacity: 1; }
}

@keyframes pop {
  from { transform: scale(0.7); opacity: 0; }
  to { transform: scale(1); opacity: 1; }
}

@keyframes candleBlink {
  0% { opacity: 0.6; transform: translateY(0); }
  50% { opacity: 1; transform: translateY(-4px); }
  100% { opacity: 0.6; transform: translateY(0); }
}
.players-grid {
  display: grid;
  grid-template-columns: 1fr 60px 1fr;
  gap: 10px;
  align-items: start;
  margin-top: 20px;
}

.players-column {
  display: flex;
  flex-direction: column;
  gap: 8px;
}

.player {
  background: rgba(255,255,255,0.2);
  padding: 8px;
  border-radius: 10px;
  font-size: 16px;
}

.divider {
  display: flex;
  flex-direction: column;
  align-items: center;
  font-size: 22px;
  opacity: 0.9;
}
</style>
<!-- Firebase SDK -->
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-firestore-compat.js"></script>

<script>
  const firebaseConfig = {
    apiKey: "Ø¶Ø¹_API_KEY_Ù‡Ù†Ø§",
    authDomain: "fateel-game.firebaseapp.com",
    projectId: "fateel-game",
    storageBucket: "fateel-game.appspot.com",
    messagingSenderId: "XXXXXXXX",
    appId: "XXXXXXXX"
  };

  firebase.initializeApp(firebaseConfig);
  const db = firebase.firestore();
</script>
</head>

<body>

<!-- Ù…ÙˆØ³ÙŠÙ‚Ù‰ Ø®Ø§ØµØ© (ØªØ¹Ù…Ù„ Ø¨Ø¹Ø¯ Ø§Ù„Ø¶ØºØ·) -->
<audio id="bells" loop>
  <source src="anthem.mp3" type="audio/mpeg">
  Ø§Ù„Ù…ØªØµÙØ­ Ù„Ø§ ÙŠØ¯Ø¹Ù… ØªØ´ØºÙŠÙ„ Ø§Ù„ØµÙˆØª
</audio>

<div class="hero">
  <img src="https://i.ibb.co/35RJp9Xb/logo.png" class="logo">
  <div class="title">ÙØªÙŠÙ„ â¤ï¸ğŸ”¥</div>
  <div>ğŸ„ Happy New Year ğŸ„</div>

  <div class="images">
    <img src="https://i.ibb.co/bjyMfxx7/santa.png">
    <img src="https://i.ibb.co/sp5Whbwq/tree.png">
  </div>
</div>

<div class="box">
ğŸ„ Happy new year ğŸ„<br>
ÙØªÙŠÙ„ â¤ï¸ğŸ”¥<br>
Ù…Ø¬Ù…ÙˆØ¹Ø© Ø§Ù„Ø¨Ø´Ø§Ø±Ø© Ø§Ù„Ù…ÙØ±Ø­Ø© Ø§Ù„ÙƒØ´ÙÙŠØ©<br><br>
Ù†Ø±Ø­Ø¨ Ø¨Ùƒ Ø¯Ø§Ø¦Ù…Ù‹Ø§ Ù…Ø¹Ù†Ø§ ÙˆÙ†ÙØ±Ø­ Ø¨ÙˆØ¬ÙˆØ¯Ùƒ ÙÙŠ ÙˆØ³Ø·Ù†Ø§<br>
ØªØ¹Ø§Ù„ Ù†Ø¨Ø¯Ø£ Ù…Ø¹Ù‹Ø§ Ø³Ù†Ø© Ø¬Ø¯ÙŠØ¯Ø© Ø¨ÙˆØ¬ÙˆØ¯ Ø±Ø¨Ù†Ø§ ÙÙŠ Ø­ÙŠØ§ØªÙƒ<br>
Ø§Ø¬Ø¹Ù„ Ø¹Ø§Ù… 2026 Ù†ÙˆØ± Ù„Ø­ÙŠØ§ØªÙƒ ÙˆÙ„Ù„Ø¢Ø®Ø±ÙŠÙ†<br>
Ø£Ù†ØªÙ… Ù†ÙˆØ± Ø§Ù„Ø¹Ø§Ù„Ù… â¤ï¸ğŸ”¥<br><br>
Ø§ÙƒØªØ¨ Ø§Ø³Ù…Ùƒ Ø§Ù„Ø­Ù‚ÙŠÙ‚ÙŠ Ø¨Ø§Ù„Ù„ØºØ© Ø§Ù„Ø¹Ø±Ø¨ÙŠØ© ÙˆØ§Ø¶ØºØ·<br>
ÙˆØ§Ù†ØªØ¸Ø± Ø§Ù„Ù…ÙØ§Ø¬Ø£Ø© ğŸ’¥ğŸğŸŠ
</div>

<input id="myName" placeholder="Ø§ÙƒØªØ¨ Ø§Ø³Ù…Ùƒ Ø§Ù„Ø­Ù‚ÙŠÙ‚ÙŠ Ø¨Ø§Ù„Ø¹Ø±Ø¨ÙŠ">
<br>
<button id="startBtn" onclick="start()" disabled>
ğŸ”¥ Ø§Ø¨Ø¯Ø£ ÙØªÙŠÙ„Ùƒ
</button>

<br>
<button onclick="toggleMusic()">ğŸµ ØªØ´ØºÙŠÙ„ / Ø¥ÙŠÙ‚Ø§Ù Ø§Ù„Ù…ÙˆØ³ÙŠÙ‚Ù‰</button>

<div id="result" class="box">
  <div>
    <span id="chosenName"></span>
    <span id="candle">ğŸ•¯ï¸</span>
  </div>

  <p>Ø§Ù„ÙØªÙŠÙ„ Ù‡Ùˆ Ø§Ù„Ø®ÙŠØ· Ø§Ù„Ø¨Ø³ÙŠØ· Ø§Ù„Ø°ÙŠ ÙŠØ®ØªØ¨Ø¦ Ø¯Ø§Ø®Ù„ Ø§Ù„Ø´Ù…Ø¹Ø©ØŒ Ù„Ø§ Ø£Ø­Ø¯ ÙŠØ±Ø§Ù‡ØŒ Ù„ÙƒÙ† Ø¨Ø¯ÙˆÙ†Ù‡ Ù„Ø§ ÙŠÙˆØ¬Ø¯ Ù†ÙˆØ±.</p>
  <p>ØµÙ„Ø§ØªÙƒ Ù…Ù† Ø£Ø¬Ù„ Ø§Ù„Ø¢Ø®Ø± ÙÙŠ Ø§Ù„Ø®ÙØ§Ø¡ Ù‡ÙŠ "Ø§Ù„ÙØªÙŠÙ„". Ù‚Ø¯ Ù„Ø§ ÙŠØ±Ø§Ùƒ Ø§Ù„Ù†Ø§Ø³ ÙˆØ£Ù†Øª ØªØµÙ„ÙŠØŒ ÙˆÙ‚Ø¯ Ù„Ø§ ÙŠØ¹Ø±Ù Ø§Ù„Ø´Ø®Øµ Ø£Ù†Ùƒ Ø°ÙƒØ±ØªÙ‡ØŒ Ù„ÙƒÙ† ØµÙ„Ø§ØªÙƒ Ù‡ÙŠ Ø§Ù„ØªÙŠ Ø£Ø¨Ù‚Øª Ù†ÙˆØ±Ù‡ Ù…Ø´ØªØ¹Ù„Ø§Ù‹.</p>
  <p><b>Ø®Ù„Ù ÙƒÙ„ Ù†ÙˆØ±.. ØµÙ„Ø§Ø©.</b></p>
  <p>Ù„ÙƒÙŠ Ù†ÙƒÙˆÙ† Ø­Ù‚Ù‹Ø§ "Ù†ÙˆØ± Ø§Ù„Ø¹Ø§Ù„Ù…"ØŒ Ù„Ø§Ø²Ù… Ù‚Ù„ÙˆØ¨Ù†Ø§ ØªÙƒÙˆÙ† "ÙØªÙŠÙ„" Ù…Ø´ØªØ¹Ù„ Ø¨Ø§Ù„Ù…Ø­Ø¨Ø©.</p>
  <p>Ø§Ø·Ù„Ø¨ Ø§Ù„ØµÙ„Ø§Ø© Ø¯Ø§Ø¦Ù…Ù‹Ø§ Ù…Ù† Ø£Ø¬Ù„ Ø£Ø®ÙˆÙƒ Ø§Ù„Ù„ÙŠ Ø§Ø³Ù…Ù‡ Ø¸Ù‡Ø± Ù‚Ø¯Ø§Ù…ÙƒØŒ ÙÙ‡ÙŠ Ø£Ø¬Ù…Ù„ Ù‡Ø¯ÙŠØ© ØªÙ‚Ø¯Ù…Ù‡Ø§ Ù„Ù‡ ÙÙŠ Ø¨Ø¯Ø§ÙŠØ© Ø§Ù„Ø¹Ø§Ù… Ø§Ù„Ø¬Ø¯ÙŠØ¯.</p>
  <p><b>ÙƒÙ† Ø§Ù„ÙØªÙŠÙ„ Ø§Ù„Ø°ÙŠ ÙŠØ­Ù…Ù„ Ø§Ù„Ù†ÙˆØ± Ù„Ù„Ø¹Ø§Ù„Ù….</b></p>
  <p>ÙƒÙ„ Ø³Ù†Ø© ÙˆØ§Ù†Øª Ø·ÙŠØ¨ ÙŠØ§ Ù‚Ø§Ø¦Ø¯ â¤ï¸</p>
</div>

<!-- Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ø£Ø³Ù…Ø§Ø¡ -->
<div id="playersSection" class="box" style="display:none;">
<div id="counter" style="margin-bottom:15px; font-size:18px;">
  ğŸ•¯ï¸ ØªÙ… Ø¥Ø´Ø¹Ø§Ù„ <span id="litCount">0</span> Ù…Ù† Ø£ØµÙ„ <span id="totalCount">0</span> ÙØªÙŠÙ„
</div>
  <h2>âœ¨ ÙØªØ§Ø¦Ù„ Ù…Ù†ÙˆØ±Ø© Ø¨Ø§Ù„ØµÙ„Ø§Ø© âœ¨</h2>

  <div id="playersList" class="players-grid">

  <div id="leftColumn" class="players-column"></div>

  <div class="divider">
    ğŸ„<br>ğŸ…<br>ğŸ„<br>ğŸ…<br>ğŸ„<br>ğŸ…
  </div>

  <div id="rightColumn" class="players-column"></div>

  </div>

  <div class="decor-line">ğŸ„ğŸ€ğŸ„ğŸ€ğŸ„ğŸ€ğŸ„</div>

  <p style="margin-top:25px;">
    ÙƒÙ„ Ø³Ù†Ø© ÙˆØ§Ù†Øª Ø·ÙŠØ¨ ÙŠØ§ Ù‚Ø§Ø¦Ø¯ â¤ï¸ğŸŠğŸ’¥ğŸ¥°
  </p>
</div>

<script>
let playersData = {};

db.collection("fateel").doc("main").onSnapshot((doc) => {
  if (!doc.exists) return;
  playersData = doc.data().players;
  
  // ØªÙØ¹ÙŠÙ„ Ø§Ù„Ø²Ø± Ø¨Ø¹Ø¯ ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª
document.getElementById("startBtn").disabled = false;
  
  // ğŸ”¢ Ø­Ø³Ø§Ø¨ Ø§Ù„Ø¹Ø¯Ø§Ø¯
const allNames = Object.keys(playersData);
const litNames = allNames.filter(name => playersData[name] === true);

document.getElementById("totalCount").innerText = allNames.length;
document.getElementById("litCount").innerText = litNames.length;

  const left = document.getElementById("leftColumn");
  const right = document.getElementById("rightColumn");

  left.innerHTML = "";
  right.innerHTML = "";

  const names = Object.keys(playersData);
  const mid = Math.ceil(names.length / 2);

  names.forEach((name, index) => {
    const div = document.createElement("div");
    div.className = "player";
    div.innerHTML = playersData[name] ? `${name} ğŸ•¯ï¸` : name;

    if (index < mid) {
      left.appendChild(div);
    } else {
      right.appendChild(div);
    }
  });
});
</script>

<script>
window.onload = function () {

  // Ù„Ùˆ Ø§Ù„Ø´Ø®Øµ Ù„Ø¹Ø¨ Ù‚Ø¨Ù„ ÙƒØ¯Ù‡ ÙÙ‚Ø·
  if (localStorage.getItem("fateelPlayed")) {

    const savedName = localStorage.getItem("fateelChosenName");

    const waitForData = setInterval(() => {
      if (Object.keys(playersData).length > 0) {

        clearInterval(waitForData);

        // Ø¥Ø¸Ù‡Ø§Ø± Ø§Ù„Ø§Ø³Ù… Ø§Ù„Ù…Ø®ØªØ§Ø±
        if (savedName) {
          const nameEl = document.getElementById("chosenName");
          const candleEl = document.getElementById("candle");
          
          nameEl.innerText = savedName;

          // Ø¥Ø¹Ø§Ø¯Ø© Ø§Ù„Ø£Ù†ÙŠÙ…ÙŠØ´Ù†
          nameEl.style.animation = "none";
          candleEl.style.animation = "none";
          void nameEl.offsetWidth;
          nameEl.style.animation = "pop 1s ease forwards";
          candleEl.style.animation = "candleBlink 1s infinite alternate";

          document.getElementById("result").style.display = "block";
          document.getElementById("playersSection").style.display = "block";
          // ğŸµ ØªØ´ØºÙŠÙ„ Ø§Ù„Ù…ÙˆØ³ÙŠÙ‚Ù‰ Ù„Ùˆ ÙƒØ§Ù†Øª Ø´ØºØ§Ù„Ø© Ù‚Ø¨Ù„ ÙƒØ¯Ù‡
   if (localStorage.getItem("fateelMusic") === "on") {
   const audio = document.getElementById("bells");
   audio.play().catch(() => {});
    musicStarted = true;
         }
        }
      }
    }, 300);
  }
};
</script>

<script>
function normalizeName(name) {
  return name.trim().replace(/\s+/g, " ");
}
</script>

<script>
function start() {

  // â›” Ù…Ù†Ø¹ Ø§Ù„ØªÙƒØ±Ø§Ø±
  if (localStorage.getItem("fateelPlayed")) {
    alert("Ø§Ù†Øª Ø¨Ø§Ù„ÙØ¹Ù„ Ø£Ø´Ø¹Ù„Øª ÙØªÙŠÙ„Ùƒ ğŸ•¯ï¸ğŸ”¥");
    return;
  }

  const inputName = normalizeName(
    document.getElementById("myName").value
  );

  if (inputName.length < 3) {
    alert("âœï¸ Ø§ÙƒØªØ¨ Ø§Ø³Ù…Ùƒ ÙƒØ§Ù…Ù„ Ù…Ù† ÙØ¶Ù„Ùƒ");
    return;
  }

  const registeredNames = Object.keys(playersData);

  const matchedName = registeredNames.find(
    n => normalizeName(n) === inputName
  );

  if (!matchedName) {
    alert("âŒ Ø§Ø³Ù…Ùƒ ØºÙŠØ± Ù…Ø³Ø¬Ù„ Ù…Ø¹Ù†Ø§");
    return;
  }

  // â›” Ø§Ù„Ø§Ø³Ù… Ø¯Ù‡ Ø´Ø§Ø±Ùƒ Ù‚Ø¨Ù„ ÙƒØ¯Ù‡
  if (playersData[matchedName] === true) {
    alert("ğŸ•¯ï¸ Ø§Ø³Ù…Ùƒ Ø´Ø§Ø±Ùƒ Ù‚Ø¨Ù„ ÙƒØ¯Ù‡ØŒ Ø´ÙƒØ±Ø§Ù‹ Ù„Ù…Ø´Ø§Ø±ÙƒØªÙƒ");
    return;
  }

  const available = registeredNames.filter(
    name => playersData[name] === false && name !== matchedName
  );

  if (available.length === 0) {
    alert("ÙƒÙ„ Ø§Ù„ÙØªØ§Ø¦Ù„ Ù†ÙˆØ±Øª ğŸ•¯ï¸ğŸ”¥");
    return;
  }

  const chosen = available[Math.floor(Math.random() * available.length)];

  db.collection("fateel").doc("main").update({
    [`players.${chosen}`]: true
  });

  localStorage.setItem("fateelPlayed", "yes");
  localStorage.setItem("fateelChosenName", chosen);

  document.getElementById("chosenName").innerText = chosen;
  document.getElementById("result").style.display = "block";
  document.getElementById("playersSection").style.display = "block";

  localStorage.setItem("fateelMusic", "on");
  musicStarted = true;
}
</script>

<script>
let musicStarted = false;

function toggleMusic() {
  const audio = document.getElementById("bells");

  if (!musicStarted) {
    audio.currentTime = 0;
    audio.play().then(() => {
      musicStarted = true;
      localStorage.setItem("fateelMusic", "on");
    }).catch(() => {
      alert("Ø§Ø¶ØºØ· Ù…Ø±Ø© Ø£Ø®Ø±Ù‰ Ù„ØªØ´ØºÙŠÙ„ Ø§Ù„Ù…ÙˆØ³ÙŠÙ‚Ù‰ ğŸµ");
    });
  } else {
    audio.pause();
    musicStarted = false;
    localStorage.setItem("fateelMusic", "off");
  }
}
</script>

<div style="
  margin-top:40px;
  font-size:14px;
  opacity:0.7;
">
  Â© 2026 Developed by <b>Michel Fouad</b>
</div>

</body>
</html>
